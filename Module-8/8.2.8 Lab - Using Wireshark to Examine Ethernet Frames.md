# 8.2.8 Lab - Using Wireshark to Examine Ethernet Frames

### Mininet Topology

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/9438e99b-864f-4d12-8bfe-ece1c7ee9a35)

## Part 1: Examine the Header Fields in an Ethernet II Frame

In Part 1, you will examine the header fields and content in an Ethernet II Frame provided to you. A Wireshark
capture will be used to examine the contents in those fields.

### Step 1: Review the Ethernet II header field descriptions and lengths.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/8b2065df-ed69-460f-8af7-48da73481168)

### Step 2: Examine Ethernet frames in a Wireshark capture.

The Wireshark capture below shows the packets generated by a ping being issued from a PC host to its
default gateway. A filter has been applied to Wireshark to view the ARP and ICMP protocols only. The
session begins with an ARP query for the MAC address of the gateway router, followed by four ping requests
and replies.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/a51d8585-fb80-4792-a493-51e909fef5ab)

### Step 3: Examine the Ethernet II header contents of an ARP request.

The following table takes the first frame in the Wireshark capture and displays the data in the Ethernet II 
header fields.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/24ecc655-fb16-4a8f-8e3c-8b33af945295)

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/d14b01b0-50e3-4b6f-93c6-ad0c28e186b3)

### What is significant about the contents of the destination address field?

      Destination address consists of Broadcast values. The destination address may be a broadcast address which contains all ones and it sends a unicast to the source address.

### Why does the PC send out a broadcast ARP prior to sending the first ping request?

      Inorder to ping or trust the other device or component, it has to know about its MAC address. Through ARP broadcast, particular device will respond by sending its MAC address as unicast and thus connection is established.

### What is the MAC address of the source in the first frame?

      f4:8c:50:62:62:6d

### What is the Vendor ID (OUI) of the Source’s NIC?

      IntelCor

### What portion of the MAC address is the OUI?

      The first 3 octets in the MAC address is the Organizational Unique Identifier (OUI)

### What is the Source’s NIC serial number?

      62:62:6d

## Part 2: Use Wireshark to Capture and Analyze Ethernet Frames

In Part 2, you will use Wireshark to capture local and remote Ethernet frames. You will then examine the 
information that is contained in the frame header fields.

### Step 1: Examine the network configuration of H3.

Start and log into your CyberOps Workstation VM using the following credentials:

      Username: analyst 
      Password: cyberops

*  Open a terminal emulator to start mininet and enter the following command at the prompt. When prompted, enter cyberops as the password

            sudo ./lab.support.files/scripts/cyberops_topo.py

* At the mininet prompt, start terminal windows on host H3

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/41d66a7e-c43d-4a1c-9938-de85ea4aceb7)

* At the prompt on Node: h3, enter ip address to verify the IPv4 address and record the MAC address.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/18005a62-2290-40e6-aa55-fb0d504c8d6c)

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/cc77c827-8663-4c13-ae49-8935b34ad4a5)

* At the prompt on Node: H3, enter netstat -r to display the default gateway information.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/2e806669-0dd1-4748-8dcc-d8b719fb7459)

What is the IP address of the default gateway for the host H3?

      10.0.0.1

### Step 2: Clear the ARP cache on H3 and start capturing traffic on H3-eth0.

* In the terminal window for Node: H3, enter arp -n to display the content of the ARP cache.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/0c140ba7-210a-4c12-a126-99e6585d798a)

* As there are no any ARP information in the cache no need to clear the cache. If any information is present then use command `arp -d <ip-addr>` untill all cached information has been cleared.

* In the terminal window for Node: H3, open Wireshark and start a packet capture for H3-eth0 interface.

### Step 3: Ping H1 from H3.

* From the terminal on H3, ping the default gateway and stop after send 5 echo request packets.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/6cfc3a1a-8aa8-436b-899f-c17bb96c3e2e)

* After the ping is completed, stop the Wireshark capture.

### Step 4: Filter Wireshark to display only ICMP traffic

* Apply the icmp filter to the captured traffic so only ICMP traffic is shown in the results.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/f4b30718-a619-4418-a378-632a211230c1)

### Step 5: Examine the first Echo (ping) request in Wireshark.

The Wireshark main window is divided into three sections: the Packet List pane (top), the Packet Details pane (middle), and the Packet Bytes pane (bottom). If you selected the correct interface for packet capturing in Step 3, Wireshark should display the ICMP information in the Packet List pane of Wireshark, similar to the following example.

* In the Packet List pane (top section), click the first frame listed. You should see Echo (ping) request under the Info heading. This should highlight the line blue.

*  Examine the first line in the Packet Details pane (middle section). This line displays the length of the frame; 98 bytes in this example.

* The second line in the Packet Details pane shows that it is an Ethernet II frame. The source and destination MAC addresses are also displayed.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/2a3be68d-e98a-42b8-80d3-f9e2fa628e53)

* What is the MAC address of the PC’s NIC?

        ca:14:71:7b:d6:ce

* What is the default gateway’s MAC address?

        52:fa:86:81:f4:f5

* You can click the arrow at the beginning of the second line to obtain more information about the Ethernet II frame.

* What type of frame is displayed?

      IPv4 (0x0800)

* The last two lines displayed in the middle section provide information about the data field of the frame. Notice that the data contains the source and destination IPv4 address information.

* What is the source IP address?

        10.0.0.13

* What is the destination IP address?

        10.0.0.1

* You can click any line in the middle section to highlight that part of the frame (hex and ASCII) in the Packet Bytes pane (bottom section). Click the Internet Control Message Protocol line in the middle section and examine what is highlighted in the Packet Bytes pane.

* Click the next frame in the top section and examine an Echo reply frame. Notice that the source and destination MAC addresses have reversed, because this frame was sent from the default gateway router as a reply to the first ping.

* What device and MAC address is displayed as the destination address?

      Previoud Source address
  
![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/541322f9-4ee5-497b-8959-81027ce7d2e6)

### Step 6: Start a new capture in Wireshark.

* Click the Start Capture icon to start a new Wireshark capture. You will receive a popup window asking if you would like to save the previous captured packets to a file before starting a new capture. Click Continue without Saving.

* In the terminal window of Node: H3, send 5 echo request packets to 172.16.0.40.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/c5ed1306-e76b-4bf8-94d1-e00f1cdabf6a)

* Stop capturing packets when the pings are completed.

### Step 7: Examine the new data in the packet list pane of Wireshark.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/75dbd28b-9d10-4d35-b544-847b807e45be)

* In the first echo (ping) request frame, what are the source and destination MAC addresses?

      Source : ca:14:71:7b:d6:ce
      Destination : 52:fa:86:81:f4:f5

* What are the source and destination IP addresses contained in the data field of the frame?

        Source : 10.0.0.13
        Destination : 172.16.0.40

* Why has the destination IP address changed, while the destination MAC address remained the same?

       When a ping is issued to a remote host, the source will use the Default Gateway’s MAC address for the frame destination. It will strip the layer 2 frame from packet and creates another frame header passing it to the next hop. Thus, it has different destination IP addressess and MAC address remains same.

### Reflection

* Wireshark does not display the preamble field of a frame header. What does the preamble contain?

        The preamble field contains seven octets of alternating 1010 sequences, and one octet that signals the beginning of the frame.
