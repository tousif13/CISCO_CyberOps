# 27.2.10 Lab - Extract an Executable from a PCAP

## Part 1: Analyze Pre-Captured Logs and Traffic Captures

* In Part 2, you will work with the `nimda.download.pcap` file. Captured in a previous lab, nimda.download.pcap contains the packets related to the download of the Nimda malware. Your version of 
the file, if you created it in the previous lab and did not reimport your CyberOps Workstation VM, is stored in the /home/analyst directory. However, a copy of that file is also stored in the CyberOps Workstation VM, 
under the `/home/analyst/lab.support.files/pcaps` directory so that you can complete this lab. For consistency of output, the lab will use the stored version in the pcaps directory
* While `tcpdump` can be used to analyze captured files, Wireshark’s graphical interface makes the task much easier. It is also important to note that tcpdump and Wireshark share the same file format for packet 
captures; therefore, PCAP files created by one tool can be opened by the other.
* Change directory to the lab.support.files/pcaps folder, and get a listing of files using the ls –l command.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/96afbfb9-edb1-486c-9599-3dcacbb0ca42)

* Issue the command below to open the nimda.download.pcap file in Wireshark. (wireshark nimda.download.pcap &)
* The `nimda.download.pcap` file contains the packet capture related to the malware download performed in a previous lab. The pcap contains all the packets sent and received while tcpdump was running. 
* Select the fourth packet in the capture and expand the Hypertext Transfer Protocol to display as shown below.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/d30f5911-e820-4c70-be4b-4db3b51c9ff2)

* Packets one through three are the TCP handshake. The fourth packet shows the request for the malware file. Confirming what was already known, the request was done over HTTP, sent as a GET request
* Because HTTP runs over TCP, it is possible to use Wireshark’s Follow TCP Stream feature to rebuild the TCP transaction. Select the first TCP packet in the capture, a SYN packet. Right-click it and choose `Follow > TCP Stream`
* Wireshark displays another window containing the details for the entire selected TCP flow

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/aee4f2ef-65e4-4f97-9cc8-433164b00f53)

* What are all those symbols shown in the Follow TCP Stream window? Are they connection noise? Data? Explain.
