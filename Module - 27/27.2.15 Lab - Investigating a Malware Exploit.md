# 27.2.15 Lab - Investigating a Malware Exploit

> You have decided to interview for a job in a medium sized company as a Tier 1 cybersecurity analyst. You 
have been asked to demonstrate your ability to pinpoint the details of an attack in which a computer was 
compromised. Your goal is to answer a series of questions using Sguil, Kibana, and Wireshark in Security 
Onion.
You have been given the following details about the event:
• The event happened in January of 2017.
• It was discovered by the Snort NIDS

## Part 1: Use Kibana to Learn About a Malware Exploit

* In Part 1, use Kibana to answer the following questions. To help you get started, you are informed that the attack took place at some time during January 2017. You will need to pinpoint the exact time.

### Step 1: Narrow the timeframe

* Login to Security Onion with the `analyst` username and `cyberops` password.
* Open Kibana (username `analyst` and password `cyberops`) and set an Absolute time range to narrow the focus to log data from January 2017.
* You will see a graph appear with a single entry showing. To view more details, you need to narrow the amount of time that is displayed. Narrow the time range in the Total Log Count Over Time visualization by clicking and dragging to select an area around the graph data point. You may need to repeat this process 
until you see some detail in the graph.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/5ae7261c-87e2-4876-8b15-4f8e974a5ffc)

### Step 2: Locate the Event in Kibana

* After narrowing the time range in the main Kibana dashboard, go to the `NIDS` Alert Data dashboard by clicking NIDS.
* Zoom in on the event by clicking and dragging in the NIDS – Alerts Over Time visualization further focus in on the event timeframe. Since the event happened over a very short period of time, select just the graph plot line. Zoom in until your display resembles the one below.

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/d62db8ee-44ea-456e-8715-8656a2d98d12)

* Click the first point on the timeline to filter for only that first event.
* Now view details for the events that occurred at that time. Scroll all the way to the bottom of the dashboard until you see the `NIDS Alerts` section of the page. The alerts are arranged by time. Expand the first event in the list by clicking the pointer arrow that is to the left of the timestamp

![image](https://github.com/tousif13/CISCO_CyberOps/assets/33444140/c666e89d-db19-4e60-ab01-7db8768f2965)

* Look at the expanded alert details and answer the following questions:
* What is the time of the first detected NIDS alert in Kibana?

      January 27th 2017 - 22:54:43

* What is the source IP address in the alert?

      172.16.4.193

* What is the destination IP address in the alert?

      194.87.234.129
  
* What is the destination port in the alert? What service is this? 

      80 port HTTP

* What is the classification of the alert? 

      trojan-activity
  
* What is the destination geo country name?

      Russia

* In a web browser on a computer that can connect to the internet, go to the link that is provided in the signature_info field of the alert. This will take you to the Emerging Threats Snort alert rule for the exploit. There are a series of rules shown. This is because signatures can change over time, or new and more 
accurate rules are developed. The newest rule is at the top of the page. Examine details of the rule

